<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>WX小程序抓包&amp;游戏封包技术 | Sat0ru_G0j0 | むりょうくうきょ</title>

  
  <meta name="author" content="Satoru">
  

  
  <meta name="description" content="不当了 不当高手！">
  

  
  <meta name="keywords" content="Penetration Testing">
  

  <meta id="viewport" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  <meta property="og:title" content="WX小程序抓包&amp;游戏封包技术"/>

  <meta property="og:site_name" content="Sat0ru_G0j0"/>

  
  <meta property="og:image" content="/favicon.ico"/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="Sat0ru_G0j0" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
<div class="blog">
  <div class="content">

    <header>
  <div class="site-branding">
    <h1 class="site-title">
      <a href="/">Sat0ru_G0j0</a>
    </h1>
    <p class="site-description">むりょうくうきょ</p>
  </div>
  <nav class="site-navigation">
    <ul>
      
        <li><a href="/archives">文档</a></li>
      
        <li><a href="/categories">分类</a></li>
      
        <li><a href="/tags">标签</a></li>
      
    </ul>
  </nav>
</header>

    <main class="site-main posts-loop">
    <article>

  
    
    <h3 class="article-title"><span>WX小程序抓包&amp;游戏封包技术</span></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2024/07/11/手机+charles+burpsuite配合抓包/" rel="bookmark">
        <time class="entry-date published" datetime="2024-07-11T06:33:00.000Z">
          2024-07-11
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <h1 id="微信小程序-公众号抓包的主流方式"><a href="#微信小程序-公众号抓包的主流方式" class="headerlink" title="微信小程序&#x2F;公众号抓包的主流方式"></a>微信小程序&#x2F;公众号抓包的主流方式</h1><p>目前有以下几种：</p>
<p>1、Windows+Burp+Proxifier（配置困难，数据包卡顿)</p>
<p>2、Burp+安卓模拟器（模拟器卡顿）</p>
<p>3、Burp+Charles（本文测试，抓包完整，放包流畅）</p>
<p>一、下载</p>
<h4 id="1、Charles官网下载安装包"><a href="#1、Charles官网下载安装包" class="headerlink" title="1、Charles官网下载安装包"></a>1、Charles官网下载安装包</h4><p><a target="_blank" rel="noopener" href="https://www.charlesproxy.com/download/latest-release/">https://www.charlesproxy.com/download/latest-release/</a></p>
<h4 id="2、Burpsuite下载"><a href="#2、Burpsuite下载" class="headerlink" title="2、Burpsuite下载"></a>2、Burpsuite下载</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://portswigger.net/burp/releases</span><br></pre></td></tr></table></figure>

<h4 id="3、Charles破解"><a href="#3、Charles破解" class="headerlink" title="3、Charles破解"></a>3、Charles破解</h4><p>进入链接，输入任意内容作为用户名，获取注册码。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.zzzmode.com/mytools/charles/</span><br></pre></td></tr></table></figure>

<p>打开Charles,打开上方工具栏中Help—Register Charles，输入用户名和激活码</p>
<p>打开Charles,打开上方工具栏中Help—Register Charles，输入用户名和激活码</p>
<h3 id="二、Charles设置"><a href="#二、Charles设置" class="headerlink" title="二、Charles设置"></a>二、Charles设置</h3><h4 id="1、Charles设置代理"><a href="#1、Charles设置代理" class="headerlink" title="1、Charles设置代理"></a>1、Charles设置代理</h4><p>打开工具栏中Proxy-Proxy Settings</p>
<p><img src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/d8c24248e8ee40169178ecc42a62836f.png" alt="img"></p>
<p>设置为如下格式</p>
<p><img src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/03f1ce83357c4a478a1c23b3a573ef16.png" alt="img"></p>
<p>然后，抓取包的规则配置（*是代表抓取任意端口和域名，如果只抓取固定的端口or域名可自行设置。）</p>
<p><img src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/60e3b14ad74f45e2af485fd4a1d13c00.png" alt="img"></p>
<p><img src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/f844baa2145b4ce182af424db5651b7b.png" alt="img"></p>
<p>接下来配置Charles代理到burpsuit的规则（我这里偷懒，配置的burp默认的8080端口，为避免端口冲突，可自行想想1-65535之内的端口，与burp协同配置即可）</p>
<p><img src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/57635112886a4064955e578ed29e42b4.png" alt="img"></p>
<p><img src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/ee5d8a67623a4979a5b0bbaf772dde94.png" alt="img"></p>
<p><img src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/41cb4950910e481c8ed2b31f31ed58d8.png" alt="img"></p>
<p><img src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/4f367272290a44edac26e6f90f6286ea.png" alt="img"></p>
<p><img src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/4fb4ca3b468a4e32a82bdf13c28f5091.png" alt="img"></p>
<h4 id="2、关闭对windows端的抓包（每次打开软件都是默认开启的，记得关闭）"><a href="#2、关闭对windows端的抓包（每次打开软件都是默认开启的，记得关闭）" class="headerlink" title="2、关闭对windows端的抓包（每次打开软件都是默认开启的，记得关闭）"></a>2、关闭对windows端的抓包（每次打开软件都是默认开启的，记得关闭）</h4><p>因为主要是联动手机对微信抓包，所以可以关闭windows端的抓包，避免干扰。</p>
<p><img src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/a9aed4740923446fbb449694c92f5a13.png" alt="img"></p>
<h4 id="3、配置PC端证书"><a href="#3、配置PC端证书" class="headerlink" title="3、配置PC端证书"></a>3、配置PC端证书</h4><p><img src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/b5ef86e515634c1099c51d03f981eae0.png" alt="img"></p>
<p><img src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/c7f39dd9529940e59a8c97313062e2b9.png" alt="img"></p>
<p><img src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/e6604a88a8a44b6d9152d69c24520b1e.png" alt="img"></p>
<p><img src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/c7750c91696b40e9b555f08b270c0501.png" alt="img"></p>
<p><img src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/10cd0da8757444da9fd7ef640f1c2169.png" alt="img"></p>
<p>点击下一步，再点击完成，PC显示导入完成就完成PC端证书配置了。</p>
<h4 id="4-移动端证书配置（我这里使用苹果手机测试）"><a href="#4-移动端证书配置（我这里使用苹果手机测试）" class="headerlink" title="4.移动端证书配置（我这里使用苹果手机测试）"></a>4.移动端证书配置（我这里使用苹果手机测试）</h4><p>在这里出现了两种可能性，依次进行即可：</p>
<h5 id="4-1手机连接电脑热点，并配置端口"><a href="#4-1手机连接电脑热点，并配置端口" class="headerlink" title="4.1手机连接电脑热点，并配置端口"></a>4.1手机连接电脑热点，并配置端口</h5><p>开启电脑热点</p>
<p><img src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/4c3aea78624043ee81d75414ffa5d693.png" alt="img"></p>
<p>手机连接热点，然后在Charles中进行如下操作：</p>
<p><img src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/506f55c1d8b843bfaf4eff5c4f57a0e1.png" alt="img"></p>
<p><img src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/186401f5edfa444fbb4dcea3daf5b8de.png" alt="img"></p>
<p><img src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/d754328f2a1f433a84ca9d9fd52be0f2.png" alt="img"></p>
<p><img src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/41b6e5105fac43e8a77eaf56d2d422d6.jpeg" alt="img"></p>
<h5 id="4-2证书下载后手机能直接识别"><a href="#4-2证书下载后手机能直接识别" class="headerlink" title="4.2证书下载后手机能直接识别"></a>4.2证书下载后手机能直接识别</h5><p>在手机上使用chrome浏览器访问下面这个网址</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chls.pro/ssl</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/fcdc424fd5874c5d8af17e280e4dbff4.jpeg" alt="img"></p>
<p><img src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/64dae3270ca34e04adbefe605f610378.jpeg" alt="img"></p>
<p>在手机中的设置路径去设置证书：<strong>设置—&gt;通用—&gt;关于本机—&gt;证书信任设置</strong>中打开对根证书启用完全信任。</p>
<p><img src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/7817da8b93ae48c2b33435669110182e.jpeg" alt="img"></p>
<p>所有的流程配置完成，现在就可以抓包了。</p>
<p>三、抓包<br>上面配置好了以后就可以开始抓包了，以后如果再有小程序、微信抓包需求直接进行以下流程即可。</p>
<p>1.打开Charles.</p>
<p>2.打开burp。on&#x2F;off拦截或者放包。</p>
<p>3.打开电脑热点，手机连接电脑热点。（如果生活中正常使用电脑热点记得把ip代理改回自动）</p>
<p>4.手机访问小程序或者公众号，在Charles和burp都可以看到包。</p>
<h3 id="同样的-我们也可以在模拟器如此部署"><a href="#同样的-我们也可以在模拟器如此部署" class="headerlink" title="同样的　我们也可以在模拟器如此部署"></a>同样的　我们也可以在模拟器如此部署</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43910861/article/details/123851267">burp+逍遥模拟器 app抓包 （导入证书到系统的解决方案）_逍遥导入证书失败-CSDN博客</a></p>
<h1 id="游戏封包技术"><a href="#游戏封包技术" class="headerlink" title="游戏封包技术"></a>游戏封包技术</h1><p>第一步：下载所需要的环境</p>
<p>雷电模拟器</p>
<p>雷电安卓模拟器-手游模拟器安卓版_android手机模拟器电脑版_雷电模拟器官网</p>
<p>ProxyDroid</p>
<p>链接：<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1F8Yv9aDZuoN3yUgDCOVRBQ">https://pan.baidu.com/s/1F8Yv9aDZuoN3yUgDCOVRBQ</a>     提取码：s4ds </p>
<p>CCProxy+WPE</p>
<p>链接: <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1HxVDuglgsEzXKsDZrSXS1Q">https://pan.baidu.com/s/1HxVDuglgsEzXKsDZrSXS1Q</a> 提取码: jti8 </p>
<p><img src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/20210704231129143.png" alt="img"></p>
<p>第二步：代理环境的配置</p>
<p>首先adb 命令查看自己的ip 在终端输入    ipconfig ,就可以查看到自己的ip, 我这里连接的是wifi,</p>
<p><img src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/20210605222428167.png" alt="img"></p>
<p>在雷电模拟器上打开安装好的  ProxyDroid.apk  ，将自己的电脑的 ip  填写在 HOST 里面，端口自己设置，不要超过 65535  ，</p>
<p><img src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/fde7482c47e14fecaf60d1662b38aa16.png" alt="img"></p>
<p> 设置好 之后  再将上面 这个开关打开</p>
<p><img src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/2ecd9200873346db9206fdb169b8981b.png" alt="img"></p>
<p>然后 在pc 端打开 CCProxy, 打开设置，端口  是 上面 app  里面填写的端口，IP 和代理app 的保持一直 都是自己电脑上的ip 。</p>
<p><img src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/20210605222522362.png" alt="img"></p>
<p>在点击下面的   高级   ，把ip改成和自己电脑的一至，再点击确定。</p>
<p><img src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/20210605222527721.png" alt="img"></p>
<p>ccproxy 还要开启账户里面的允许所有。</p>
<p><img src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/20210704230543369.png" alt="img"></p>
<p>我们再打开模拟器上的游戏，看到ccp 中有这样一条线，就能看到代理成功。</p>
<p><img src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/20210605222548577.png" alt="img"></p>
<p>接下来我们就打开 ，WPE , 在目标程序中找到ccp 的进程。</p>
<p><img src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/20210605222608143.png" alt="img"></p>
<p>在视图里面可以设置 拦截发送的数据包，还是接受到的数据包，我这里只拦截发送的数据包。</p>
<p><img src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/2021060522262510.png" alt="img"></p>
<p>设置好之后，我们进入游戏，找到游戏的中角色的升级，我们打开wpe, 点击 黑色的运行按钮，我们就能看到扇形的数据包中开始变化，点击一次升级，我们就暂停拦截，我们就取分析，拦截到的数据包，在如下的列表中我们可以很快浏览一下，我们 找到规律了，  </p>
<p><img src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/20210605222656425.png" alt="img"></p>
<p><img src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/20210605222711573.png" alt="img"></p>
<p>总结： 我们设置的ip: 172.20.4.153  我们现在就查看，只要来源和目标 ip 都是一样的。这就说明是本地和本地的发送，我们就将这些直接过滤掉， 我们剩下的也不多，就一个一个的试试，</p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/source/categories/Penetration-Testing-Basic/">Penetration Testing Basic</a>
    </span>
    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/source/tags/pr0gram/">pr0gram</a>
    </span>
    

    </div>

    
  </div>
</article>

  









    </main>

    <footer class="site-footer">
  <p class="site-info">
    Proudly powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and
    Theme by <a href="https://github.com/CodeDaraW/Hacker" target="_blank">Hacker</a>
    </br>
    
    &copy; 2024 Satoru
    
  </p>
</footer>
    
    
  </div>
</div>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>